<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>riccaticpp: riccaticpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">riccaticpp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">riccaticpp </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2_users_2sbronder_2opensource_2riccaticpp_2_r_e_a_d_m_e"></a> <img src="https://github.com/fruzsinaagocs/riccati/blob/master/logo.png?raw=true" alt="Riccati logo" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md0"></a>
riccati</h1>
<p>A package implementing the adaptive Riccati defect correction (ARDC) method</p>
<p><a href="https://doi.org/10.21105/joss.05430"><img src="https://joss.theoj.org/papers/10.21105/joss.05430/status.svg" alt="DOI" style="pointer-events: none;" class="inline"/></a> <a href="https://riccati.readthedocs.io/en/latest/?badge=latest"><img src="https://readthedocs.org/projects/riccati/badge/?version=latest" alt="Documentation Status" class="inline"/></a> <a href="https://codecov.io/gh/fruzsinaagocs/riccati"><img src="https://codecov.io/gh/fruzsinaagocs/riccati/branch/master/graph/badge.svg?token=XA47G7P1XM" alt="codecov" style="pointer-events: none;" class="inline"/></a></p>
<h2><a class="anchor" id="autotoc_md1"></a>
About</h2>
<p>This package is a C++ port of the <a href="https://github.com/fruzsinaagocs/riccati">riccati</a> python package.</p>
<p><code>riccati</code> is a <code>C++</code> package for solving ODEs of the form</p>
<p>$$ u''(t) + 2\gamma(t)u'(t) + \omega^2(t)u(t) = 0,$$</p>
<p>on some solution interval $t \in [t_0, t_1]$, and with initial conditions $u(t_0) = u_0$, $u'(t_0) = u'_0$.</p>
<p><code>riccati</code> uses the adaptive Riccati defect correction method &ndash; it switches between using nonoscillatory (spectral Chebyshev) and a specialised oscillatory solver (Riccati defect correction) to propagate the numerical solution based on its behaviour. For more details on the algorithm, please see <a href="https://github.com/stevebronder/riccaticpp/blob/master/README.md#Attribution">Attribution</a>.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Benchmarks</h2>
<p>Benchmarks are available in <code>python/benchmarks</code> and can be run with</p>
<div class="fragment"><div class="line">cmake -S . -B &quot;build&quot; -DCMAKE_BUILD_TYPE=RELEASE  -DRICCATI_BUILD_TESTING=ON</div>
<div class="line">cd build/python/benchmark</div>
<div class="line">make -j4 figgen</div>
</div><!-- fragment --><p><img src="./imgs/bremer1e6.png" alt="bench1" class="inline"/></p>
<p><img src="./imgs/bremer1e12.png" alt="bench2" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md3"></a>
Documentation</h2>
<p>Read the documentation at <a href="https://stevebronder.com/riccaticpp/">the docs site</a>.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Attribution</h2>
<p>If you find this code useful in your research, please cite <a href="https://arxiv.org/abs/2212.06924">Agocs &amp; Barnett (2022)</a>. Its BibTeX entry is </p><pre class="fragment">@ARTICLE{ardc,
       author = {{Agocs}, Fruzsina J. and {Barnett}, Alex H.},
        title = "{An adaptive spectral method for oscillatory second-order
        linear ODEs with frequency-independent cost}",
      journal = {arXiv e-prints},
     keywords = {Mathematics - Numerical Analysis},
         year = 2022,
        month = dec,
          eid = {arXiv:2212.06924},
        pages = {arXiv:2212.06924},
          doi = {10.48550/arXiv.2212.06924},
archivePrefix = {arXiv},
       eprint = {2212.06924},
 primaryClass = {math.NA},
       adsurl = {https://ui.adsabs.harvard.edu/abs/2022arXiv221206924A},
      adsnote = {Provided by the SAO/NASA Astrophysics Data System}
}
</pre><h2><a class="anchor" id="autotoc_md5"></a>
License</h2>
<p>Copyright 2024 The Simons Foundation, Inc.</p>
<p><b>riccati</b> is free software available under the BSD 3.0, for details see the <a href="https://github.com/fruzsinaagocs/riccati/blob/master/LICENSE">LICENSE</a>.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Building Tests</h2>
<p>From the top level directory you can build and call the tests with the following.</p>
<div class="fragment"><div class="line"># DEBUG build types enable 0g, ggdb3, and pretty printing helper functions in utils</div>
<div class="line">cmake -S . -B &quot;build&quot; -DCMAKE_BUILD_TYPE=RELEASE  -DRICCATI_BUILD_TESTING=ON -DRICCATI_BUILD_BENCHMARKS=ON -DRICCATI_BUILD_PYTHON=ON</div>
<div class="line">cd build/tests</div>
<div class="line">make -j4 riccati_test &amp;&amp; ctest</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Including</h2>
<p><code>riccaticpp</code> is a header only library and so any project can include it just by copy/pasting in the include folder. For cmake based projects</p>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line"> </div>
<div class="line">FetchContent_Declare(</div>
<div class="line">  riccaticpp</div>
<div class="line">  https://github.com/SteveBronder/riccaticpp</div>
<div class="line">  main # Use a specific version or commit</div>
<div class="line">)</div>
<div class="line">FetchContent_MakeAvailable(riccaticpp)</div>
<div class="line"> </div>
<div class="line"># For your target</div>
<div class="line">target_link_libraries(target_name riccati)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Python</h2>
<p><code>pyriccaticpp</code> is a <a class="el" href="namespacepybind11.html">pybind11</a> wrapper that uses <code>scikit-build-core</code> for building. It can be installed from source using</p>
<div class="fragment"><div class="line">git clone https://github.com/SteveBronder/riccaticpp</div>
<div class="line">pip install ./riccaticpp</div>
<div class="line"># optionally run tests</div>
<div class="line">cd ./riccaticpp</div>
<div class="line">pytest ./tests/python/test.py</div>
</div><!-- fragment --><p>Below is an example of calling the solver for the airy equation</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> pyriccaticpp <span class="keyword">as</span> ric</div>
<div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">import</span> scipy.special <span class="keyword">as</span> sp</div>
<div class="line">w = <span class="keyword">lambda</span> x: np.sqrt(x)</div>
<div class="line">g = <span class="keyword">lambda</span> x: np.zeros_like(x)</div>
<div class="line">info = ric.Init(w, g, 16, 32, 32, 32)</div>
<div class="line">xi = 1e0</div>
<div class="line">xf = 1e6</div>
<div class="line">eps = 1e-12</div>
<div class="line">epsh = 1e-13</div>
<div class="line">yi = complex(sp.airy(-xi)[0] + 1j * sp.airy(-xi)[2])</div>
<div class="line">dyi = complex(-sp.airy(-xi)[1] - 1j * sp.airy(-xi)[3])</div>
<div class="line">Neval = int(1e2)</div>
<div class="line">xeval = np.linspace(xf, xi, Neval)</div>
<div class="line">xs, ys, dys, ss, ps, stypes, yeval, dyeval = ric.evolve(</div>
<div class="line">    info, xi, xf, yi, dyi, eps, epsh, init_stepsize=0.01, x_eval=xeval</div>
<div class="line">)</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
