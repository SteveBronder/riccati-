<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>riccaticpp: riccati::arena_alloc Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">riccaticpp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classriccati_1_1arena__alloc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classriccati_1_1arena__alloc-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">riccati::arena_alloc Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="memory_8hpp_source.html">memory.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3f78e32470da8e837af28cf12fb127ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8hpp.html#a02b0c8f3ef24b543752c195ab745a094">RICCATI_NO_INLINE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#a3f78e32470da8e837af28cf12fb127ab">arena_alloc</a> (size_t initial_nbytes=<a class="el" href="namespacericcati_1_1internal.html#a20aac1321fcad0ffc2f7f35a5876b0f9">internal::DEFAULT_INITIAL_NBYTES</a>)</td></tr>
<tr class="separator:a3f78e32470da8e837af28cf12fb127ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33737e7174ade96db8687d61fa44c23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8hpp.html#a02b0c8f3ef24b543752c195ab745a094">RICCATI_NO_INLINE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#ae33737e7174ade96db8687d61fa44c23">~arena_alloc</a> ()</td></tr>
<tr class="separator:ae33737e7174ade96db8687d61fa44c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0610f2fd9d9706bd24c07e360cd7fb83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8hpp.html#acdf1d6c97f4534c3a90cf00d934c4bb0">RICCATI_ALWAYS_INLINE</a> void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#a0610f2fd9d9706bd24c07e360cd7fb83">alloc</a> (size_t len)</td></tr>
<tr class="separator:a0610f2fd9d9706bd24c07e360cd7fb83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cfb5577ed6f7ff013ae70d03c2b8f07"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a8cfb5577ed6f7ff013ae70d03c2b8f07"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="macros_8hpp.html#acdf1d6c97f4534c3a90cf00d934c4bb0">RICCATI_ALWAYS_INLINE</a> T *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#a8cfb5577ed6f7ff013ae70d03c2b8f07">alloc_array</a> (size_t n)</td></tr>
<tr class="separator:a8cfb5577ed6f7ff013ae70d03c2b8f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad2ef8e2495c4f1d7c198b3c72a843ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="macros_8hpp.html#acdf1d6c97f4534c3a90cf00d934c4bb0">RICCATI_ALWAYS_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#aad2ef8e2495c4f1d7c198b3c72a843ef">recover_all</a> ()</td></tr>
<tr class="separator:aad2ef8e2495c4f1d7c198b3c72a843ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd096644f3afc9c1a2a00273e5352dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#abfd096644f3afc9c1a2a00273e5352dd">free_all</a> ()</td></tr>
<tr class="separator:abfd096644f3afc9c1a2a00273e5352dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22dc0386d18b0784a0e08d279f143fce"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#a22dc0386d18b0784a0e08d279f143fce">bytes_allocated</a> () const</td></tr>
<tr class="separator:a22dc0386d18b0784a0e08d279f143fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2960f970183123a600f92c515302d90"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classriccati_1_1arena__alloc.html#ae2960f970183123a600f92c515302d90">in_stack</a> (const void *ptr) const</td></tr>
<tr class="separator:ae2960f970183123a600f92c515302d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An instance of this class provides a memory pool through which blocks of raw memory may be allocated and then collected simultaneously.</p>
<p>This class is useful in settings where large numbers of small objects are allocated and then collected all at once. This may include objects whose destructors have no effect.</p>
<p>Memory is allocated on a stack of blocks. Each block allocated is twice as large as the previous one. The memory may be recovered, with the blocks being reused, or all blocks may be freed, resetting the stack of blocks to its original state.</p>
<p>Alignment up to 8 byte boundaries guaranteed for the first malloc, and after that it's up to the caller. On 64-bit architectures, all struct values should be padded to 8-byte boundaries if they contain an 8-byte member or a virtual function. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3f78e32470da8e837af28cf12fb127ab" name="a3f78e32470da8e837af28cf12fb127ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f78e32470da8e837af28cf12fb127ab">&#9670;&#160;</a></span>arena_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8hpp.html#a02b0c8f3ef24b543752c195ab745a094">RICCATI_NO_INLINE</a> riccati::arena_alloc::arena_alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>initial_nbytes</em> = <code><a class="el" href="namespacericcati_1_1internal.html#a20aac1321fcad0ffc2f7f35a5876b0f9">internal::DEFAULT_INITIAL_NBYTES</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Construct a resizable stack allocator initially holding the specified number of bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initial_nbytes</td><td>Initial number of bytes for the allocator. Defaults to <code>(1 &lt;&lt; 16) = 64KB</code> initial bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the underlying malloc is not 8-byte aligned. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="macros_8hpp.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>.</p>

</div>
</div>
<a id="ae33737e7174ade96db8687d61fa44c23" name="ae33737e7174ade96db8687d61fa44c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33737e7174ade96db8687d61fa44c23">&#9670;&#160;</a></span>~arena_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8hpp.html#a02b0c8f3ef24b543752c195ab745a094">RICCATI_NO_INLINE</a> riccati::arena_alloc::~arena_alloc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy this memory allocator.</p>
<p>This is implemented as a no-op as there is no destruction required. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0610f2fd9d9706bd24c07e360cd7fb83" name="a0610f2fd9d9706bd24c07e360cd7fb83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0610f2fd9d9706bd24c07e360cd7fb83">&#9670;&#160;</a></span>alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8hpp.html#acdf1d6c97f4534c3a90cf00d934c4bb0">RICCATI_ALWAYS_INLINE</a> void * riccati::arena_alloc::alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a newly allocated block of memory of the appropriate size managed by the stack allocator.</p>
<p>The allocated pointer will be 8-byte aligned. If the number of bytes requested is not a multiple of 8, the reserved space will be padded up to the next multiple of 8.</p>
<p>This function may call C++'s <code>malloc()</code> function, with any exceptions percolated through this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>Number of bytes to allocate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the allocated memory. </dd></dl>

<p class="reference">References <a class="el" href="macros_8hpp.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>.</p>

</div>
</div>
<a id="a8cfb5577ed6f7ff013ae70d03c2b8f07" name="a8cfb5577ed6f7ff013ae70d03c2b8f07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cfb5577ed6f7ff013ae70d03c2b8f07">&#9670;&#160;</a></span>alloc_array()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8hpp.html#acdf1d6c97f4534c3a90cf00d934c4bb0">RICCATI_ALWAYS_INLINE</a> T * riccati::arena_alloc::alloc_array </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocate an array on the arena of the specified size to hold values of the specified template parameter type.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>type of entries in allocated array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of array to allocate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new array allocated on the arena. </dd></dl>

<p class="reference">References <a class="el" href="classriccati_1_1arena__alloc.html#a0610f2fd9d9706bd24c07e360cd7fb83">alloc()</a>.</p>

</div>
</div>
<a id="a22dc0386d18b0784a0e08d279f143fce" name="a22dc0386d18b0784a0e08d279f143fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22dc0386d18b0784a0e08d279f143fce">&#9670;&#160;</a></span>bytes_allocated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t riccati::arena_alloc::bytes_allocated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return number of bytes allocated to this instance by the heap. This is not the same as the number of bytes allocated through calls to memalloc_. The latter number is not calculatable because space is wasted at the end of blocks if the next alloc request doesn't fit. (Perhaps we could trim down to what is actually used?)</p>
<dl class="section return"><dt>Returns</dt><dd>number of bytes allocated to this instance </dd></dl>

</div>
</div>
<a id="abfd096644f3afc9c1a2a00273e5352dd" name="abfd096644f3afc9c1a2a00273e5352dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfd096644f3afc9c1a2a00273e5352dd">&#9670;&#160;</a></span>free_all()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void riccati::arena_alloc::free_all </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Free all memory used by the stack allocator other than the initial block allocation back to the system. Note: the destructor will free all memory. </p>

<p class="reference">References <a class="el" href="classriccati_1_1arena__alloc.html#aad2ef8e2495c4f1d7c198b3c72a843ef">recover_all()</a>.</p>

</div>
</div>
<a id="ae2960f970183123a600f92c515302d90" name="ae2960f970183123a600f92c515302d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2960f970183123a600f92c515302d90">&#9670;&#160;</a></span>in_stack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool riccati::arena_alloc::in_stack </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indicates whether the memory in the pointer is in the stack.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>memory location </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the pointer is in the stack, false otherwise. </dd></dl>

</div>
</div>
<a id="aad2ef8e2495c4f1d7c198b3c72a843ef" name="aad2ef8e2495c4f1d7c198b3c72a843ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad2ef8e2495c4f1d7c198b3c72a843ef">&#9670;&#160;</a></span>recover_all()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="macros_8hpp.html#acdf1d6c97f4534c3a90cf00d934c4bb0">RICCATI_ALWAYS_INLINE</a> void riccati::arena_alloc::recover_all </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Recover all the memory used by the stack allocator. The stack of memory blocks allocated so far will be available for further allocations. If more than one block exists, all memory is freed and then one large allocation takes place to allow only a single block of memory. To free memory back to the system, use the function <a class="el" href="classriccati_1_1arena__alloc.html#abfd096644f3afc9c1a2a00273e5352dd">free_all()</a>. </p>

<p class="reference">References <a class="el" href="namespacericcati_1_1internal.html#af325c8816465cecca88024e7eb4522ca">riccati::internal::eight_byte_aligned_malloc()</a>, and <a class="el" href="macros_8hpp.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/sbronder/open_source/riccaticpp/include/riccati/<a class="el" href="memory_8hpp_source.html">memory.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacericcati.html">riccati</a></li><li class="navelem"><a class="el" href="classriccati_1_1arena__alloc.html">arena_alloc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
